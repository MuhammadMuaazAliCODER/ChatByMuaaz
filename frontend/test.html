<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChatApp - Chats</title>
    <style>
        /* ------------------ General ------------------ */
        body { margin: 0; font-family: Arial, sans-serif; background: #f5f5f5; }
        button { cursor: pointer; }
        .chat-container { display: flex; height: 100vh; }

        /* ------------------ Sidebar ------------------ */
        .sidebar { width: 300px; background: #fff; border-right: 1px solid #ccc; display: flex; flex-direction: column; }
        .sidebar-header { padding: 10px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #ddd; }
        .user-info { display: flex; align-items: center; }
        .avatar { width: 40px; height: 40px; border-radius: 50%; background: #bbb; display: flex; justify-content: center; align-items: center; color: #fff; font-weight: bold; }
        .avatar.small { width: 35px; height: 35px; font-size: 14px; }
        .user-details { margin-left: 10px; }
        .status { font-size: 12px; color: gray; }
        .status.online { color: green; }

        .header-actions button { background: none; border: none; font-size: 18px; margin-left: 5px; position: relative; }
        .badge { background: red; color: #fff; border-radius: 50%; padding: 2px 6px; font-size: 10px; position: absolute; top: -5px; right: -5px; display: none; }

        .search-box input { width: calc(100% - 20px); margin: 10px; padding: 8px; border-radius: 5px; border: 1px solid #ccc; }

        .tabs { display: flex; border-bottom: 1px solid #ddd; }
        .tabs button { flex: 1; padding: 10px; border: none; background: #f5f5f5; font-weight: bold; }
        .tabs button.active { background: #fff; border-bottom: 2px solid #007bff; color: #007bff; }

        .tab-content { flex: 1; overflow-y: auto; padding: 10px; display: none; }
        .tab-content.active { display: block; }

        .friends-actions { margin-bottom: 10px; }
        .btn-secondary { padding: 5px 10px; border: 1px solid #007bff; background: #fff; color: #007bff; border-radius: 5px; }

        .friends-list .friend-item, .chats-list .chat-item { display: flex; align-items: center; padding: 5px; border-bottom: 1px solid #eee; cursor: pointer; }
        .friends-list .friend-item:hover, .chats-list .chat-item:hover { background: #f0f0f0; }
        .friend-info { margin-left: 10px; }
        .friend-info h4 { margin: 0; font-size: 14px; }
        .friend-info .status { font-size: 12px; }

        /* ------------------ Main Chat Area ------------------ */
        .chat-main { flex: 1; display: flex; flex-direction: column; background: #e5ddd5; }
        .welcome-screen { flex: 1; display: flex; justify-content: center; align-items: center; text-align: center; }
        .chat-header { display: flex; justify-content: space-between; padding: 10px; background: #fff; border-bottom: 1px solid #ccc; }
        .chat-user-info { display: flex; align-items: center; }
        .messages-container { flex: 1; overflow-y: auto; padding: 10px; }
        .chat-input { display: flex; align-items: center; padding: 10px; background: #fff; border-top: 1px solid #ccc; }
        .chat-input input { flex: 1; padding: 8px; margin: 0 5px; border-radius: 5px; border: 1px solid #ccc; }
        .btn-send { padding: 8px 12px; background: #007bff; color: #fff; border: none; border-radius: 5px; }

        /* ------------------ Empty State ------------------ */
        .empty-state { text-align: center; color: gray; padding: 20px; font-size: 14px; }
    </style>
</head>
<body>
    <div class="chat-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="user-info">
                    <div class="avatar" id="currentUserAvatar">U</div>
                    <div class="user-details">
                        <h3 id="currentUserName">User</h3>
                        <span class="status online">Online</span>
                    </div>
                </div>
                <div class="header-actions">
                    <button class="icon-btn" id="themeToggle" title="Toggle theme">ðŸŒ™</button>
                    <button class="icon-btn" id="friendRequestsBtn" title="Friend Requests">
                        ðŸ‘¥<span class="badge" id="requestsBadge">0</span>
                    </button>
                    <button class="icon-btn" id="logoutBtn" title="Logout">ðŸšª</button>
                </div>
            </div>

            <div class="search-box">
                <input type="text" id="searchInput" placeholder="ðŸ” Search users...">
            </div>

            <div class="tabs">
                <button class="tab active" data-tab="chats">Chats</button>
                <button class="tab" data-tab="friends">Friends</button>
            </div>

            <!-- Chats List -->
            <div class="tab-content active" id="chatsTab">
                <div id="chatsList" class="chats-list">
                    <div class="empty-state">
                        <p>No chats yet</p>
                        <small>Search for users to start chatting</small>
                    </div>
                </div>
            </div>

            <!-- Friends List -->
            <div class="tab-content" id="friendsTab">
                <div class="friends-actions">
                    <button class="btn-secondary" id="addFriendBtn">+ Add Friend</button>
                </div>
                <div id="friendsList" class="friends-list">
                    <div class="empty-state">
                        <p>No friends yet</p>
                        <small>Add friends to start chatting</small>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Chat Area -->
        <main class="chat-main">
            <div class="welcome-screen">
                <div class="welcome-content">
                    <h2>ðŸ’¬ Welcome to ChatApp</h2>
                    <p>Select a chat to start messaging</p>
                </div>
            </div>
        </main>
    </div>
 <script src="config.js"></script>
    <script src="utils.js"></script>
    <script src="websocket.js"></script>
    <script src="friends.js"></script>
    <script src="chat.js"></script>
    <script>
        // ------------------ Demo Data ------------------
        let friends = [
            { _id: '1', name: 'Ali', verified: true },
            { _id: '2', name: 'Sara', verified: false },
            { _id: '3', name: 'Ahmed', verified: true }
        ];

        // ------------------ Helper Functions ------------------
        function createAvatar(name, size) {
            const div = document.createElement('div');
            div.className = `avatar ${size}`;
            div.textContent = name[0];
            return div;
        }

        function escapeHtml(str) {
            return str.replace(/[&<>"']/g, m => ({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;' }[m]));
        }

        function checkUserOnline(id) {
            return Math.random() > 0.5; // demo online status
        }

        function startDirectChat(userId) {
            alert('Start chat with user ID: ' + userId);
        }

        // ------------------ Render Friends ------------------
        function renderFriendsList() {
            const container = document.getElementById('friendsList');
            if (!container) return;

            if (!friends || friends.length === 0) {
                container.innerHTML = `<div class="empty-state">
                    <p>ðŸ‘¥ No friends yet</p>
                    <small>Add friends to start chatting</small>
                </div>`;
                return;
            }

            container.innerHTML = friends.map(friend => {
                const online = checkUserOnline(friend._id);
                return `
                    <div class="friend-item" data-user-id="${friend._id}">
                        ${createAvatar(friend.name,'small').outerHTML}
                        <div class="friend-info">
                            <h4>${escapeHtml(friend.name)} ${friend.verified ? '<span class="verified"></span>' : ''}</h4>
                            <span class="status ${online?'online':''}">${online?'Online':'Offline'}</span>
                        </div>
                    </div>
                `;
            }).join('');

            container.querySelectorAll('.friend-item').forEach(item => {
                item.addEventListener('click', () => {
                    const userId = item.dataset.userId;
                    startDirectChat(userId);
                });
            });
        }

        // ------------------ Init ------------------
        document.addEventListener('DOMContentLoaded', () => {
            renderFriendsList();
        });
    </script>
     
</body>
</html>
